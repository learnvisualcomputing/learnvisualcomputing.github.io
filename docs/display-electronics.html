<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>20&nbsp; Driving Circuits – Foundations of Visual Computing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./display-signal-processing.html" rel="next">
<link href="./display-optics.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./display.html">Display</a></li><li class="breadcrumb-item"><a href="./display-electronics.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Driving Circuits</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Foundations of Visual Computing</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/learnvisualcomputing/learnvisualcomputing.github.io" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Foundations-of-Visual-Computing.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">An Invitation to Visual Computing</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./hvs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Human Visual System</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">From Light to Vision</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-receptor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Photoreceptors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-color.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Color Vision</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-colorimetry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Colorimetry</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Visual Adaptations and Constancy</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./rendering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rendering</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Overview</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-radiometry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Radiometry and Photometry</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-lightfield.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Light Field</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-re.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Rendering Surface Scattering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-surface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modeling Material Surface</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-sss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Volume and Subsurface Scattering Processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-rte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Rendering Volume and Subsurface Scattering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-nflux.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">The N-Flux Theory</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./imaging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Imaging</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./imaging-optics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Imaging Optics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./imaging-sensor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Image Sensor Architecture</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./imaging-noise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Noise</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./imaging-isp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Camera Signal Processing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./display.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Display</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./display-optics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Optical Mechanisms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./display-electronics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Driving Circuits</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./display-signal-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Display Signal Processing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-disp-bp" id="toc-sec-disp-bp" class="nav-link active" data-scroll-target="#sec-disp-bp"><span class="header-section-number">20.1</span> Backplane</a>
  <ul class="collapse">
  <li><a href="#lcd-vs.-oled" id="toc-lcd-vs.-oled" class="nav-link" data-scroll-target="#lcd-vs.-oled"><span class="header-section-number">20.1.1</span> LCD vs.&nbsp;OLED</a></li>
  <li><a href="#active-matrix-vs.-passive-matrix" id="toc-active-matrix-vs.-passive-matrix" class="nav-link" data-scroll-target="#active-matrix-vs.-passive-matrix"><span class="header-section-number">20.1.2</span> Active Matrix vs.&nbsp;Passive Matrix</a></li>
  </ul></li>
  <li><a href="#sec-disp-dic" id="toc-sec-disp-dic" class="nav-link" data-scroll-target="#sec-disp-dic"><span class="header-section-number">20.2</span> Driver IC</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/learnvisualcomputing/learnvisualcomputing.github.io/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./display.html">Display</a></li><li class="breadcrumb-item"><a href="./display-electronics.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Driving Circuits</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-disp-elec" class="quarto-section-identifier"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Driving Circuits</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Now that we understand how displays produce color and control luminance, let’s take a step back and ask: since all we get from an image is array of pixels, how do we actually control the display color and luminance from image pixel values? This requires a combination of display signal processing algorithms that turn image pixel values to actual digital values sent to the display, which is the topic of next chapter, and the driving circuits that use the digital values to actually drive the emissive devices, which we focus on in this chapter.</p>
<p>There are two main components in the driving circuits: 1) the backplane that sits directly at the back of a display panel and that controls the emissive devices (<a href="#sec-disp-bp" class="quarto-xref"><span>Section 20.1</span></a>), and 2) the driver integrated circuit (IC) that delivers the driver signals to the backplane (<a href="#sec-disp-dic" class="quarto-xref"><span>Section 20.2</span></a>).</p>
<section id="sec-disp-bp" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="sec-disp-bp"><span class="header-section-number">20.1</span> Backplane</h2>
<p>Mechanically, a display panel has an emissive layer at the front that contains the optical devices we have seen in the previous chapter and a <em>backplane</em> that sits right behind and delivers electrical signals to the emissive layer. The main component of the backplane is the driving circuit, which delivers electrical signals to drive the LEDs/LC cells. The driving circuit differs between LCDs and (O)LED displays, and can use either an active matrix (AM) architecture of a passive matrix (PM) architecture.</p>
<section id="lcd-vs.-oled" class="level3" data-number="20.1.1">
<h3 data-number="20.1.1" class="anchored" data-anchor-id="lcd-vs.-oled"><span class="header-section-number">20.1.1</span> LCD vs.&nbsp;OLED</h3>
<p>As far as driving is concerned, the main difference between an LED and an LC cell is that LED is a current-driven device and an LC cell is a voltage-driven device. An LED emits photons because of the injected current that flows through it. LC cells do not emit photons themselves — the backlight does. The LC cells change their optical properties (the ability to rotate the polarization of incident light) in response to external voltage, and there is very little current that flows through the LC cells.</p>
<p>Therefore, to drive an LC cell, we need to maintain an external voltage. In contrast, to drive an LED, we need to maintain a flow of current, which will cause a voltage potential difference across the LED but that is the by-product of the injected current.</p>
<p><a href="#fig-lcd_oled_pixel" class="quarto-xref">Figure&nbsp;<span>20.1</span></a> compares the driving circuit between an LC cell and an OLED pixel. In the LC case, each pixel has an LC cell, a storage capacitor <span class="math inline">\(C_{storage}\)</span>, and a switching transistor, usually a thin-film transistor (TFT). When <span class="math inline">\(V_{Select}\)</span> is activated, the TFT allows <span class="math inline">\(C_{storage}\)</span> to be charged by <span class="math inline">\(V_{Data}\)</span>. The voltage stored in <span class="math inline">\(C_{storage}\)</span> then drives the LC cell. In PAM, the voltage value is determined by the intended luminance based on the transmittance-vs-voltage curve (<a href="display-optics.html#sec-disp-optics-lum-pam" class="quarto-xref"><span>Section 19.3.1</span></a>). In PWM, the voltage is fixed but duration at which <span class="math inline">\(V_{Select}\)</span> is activated is luminance dependent.</p>
<div id="fig-lcd_oled_pixel" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lcd_oled_pixel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/lcd_oled_pixel.svg" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lcd_oled_pixel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.1: Comparison the driving circuit inside (a) an LCD pixel and (b) an OLED pixel. Both use the active matrix design, where there are in-pixel TFTs and capacitors to store data and control each pixel. Adapted from <span class="citation" data-cites="ma2016active">Ma (<a href="references.html#ref-ma2016active" role="doc-biblioref">2016, fig. 1</a>)</span>.
</figcaption>
</figure>
</div>
<p>The in-pixel driving circuit for an OLED is slightly more complicated because of its current driven nature. As shown in <a href="#fig-lcd_oled_pixel" class="quarto-xref">Figure&nbsp;<span>20.1</span></a> (b), each pixel has two TFTs and a storage capacitor, hence the name 2T1C design. The switching TFT acts similarly to that in the LC case, allowing <span class="math inline">\(C_{storage}\)</span> to be charged. The voltage across <span class="math inline">\(C_{storage}\)</span> is then <span class="math inline">\(V_{DD} - V_{Data}\)</span>.</p>
<p>To deliver a current to the OLED, however, having only the voltage in <span class="math inline">\(C_{storage}\)</span> is not enough; we need another TFT, the driving TFT. The driving TFT (like any transistor) has three terminals: the source terminal is connected to one side of the capacitor and <span class="math inline">\(V_{DD}\)</span>, the gate terminal is connected to the other side of the capacitor, and the drain terminal is connected to the OLED<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. The gate-source voltage of the TFT, <span class="math inline">\(V_{gs}\)</span>, is equivalent to the voltage across <span class="math inline">\(C_{storage}\)</span>. Given <span class="math inline">\(V_{gs}\)</span>, the current that flows through the drain terminal <span class="math inline">\(I_d\)</span>, which is also the current injected to the OLED <span class="math inline">\(I_{OLED}\)</span> (because of Kirchhoff’s first law), is given by <span class="citation" data-cites="ma2016active">(<a href="references.html#ref-ma2016active" role="doc-biblioref">Ma 2016, p. 1829</a>)</span>:</p>
<p><span id="eq-tft_iv"><span class="math display">\[
\begin{aligned}
    I_{OLED} = I_d = k(V_{gs} - V_{th})^2, \\
    V_{gs} = V_{DD} - V_{Data},
\end{aligned}
\tag{20.1}\]</span></span></p>
<p>where <span class="math inline">\(V_{th}\)</span> is the threshold voltage of the TFT and k is a constant that depends on inherent properties of the transistor. <span class="math inline">\(V_{Data}\)</span> is properly set so that the resulting <span class="math inline">\(I_{OLED}\)</span> gives us the desired luminance (according to <a href="display-optics.html#eq-led_lum" class="quarto-xref">Equation&nbsp;<span>19.1</span></a>).</p>
<p>We can see that we do not directly control the voltage across the OLED. As the current <span class="math inline">\(I_d\)</span> flows through the OLED, there is naturally a voltage difference across the OLED (given by <a href="display-optics.html#eq-led_iv" class="quarto-xref">Equation&nbsp;<span>19.2</span></a>), which is also the voltage at the drain terminal (since the other side of the OLED is connected to ground). The only thing we have to make sure of is <span class="math inline">\(V_{ds} \geq V_{gs} - V_{th}\)</span> (where <span class="math inline">\(V_{ds}\)</span> is the voltage across the drain and source terminals) so that the TFT operates in the saturation region where <a href="#eq-tft_iv" class="quarto-xref">Equation&nbsp;<span>20.1</span></a> holds.</p>
<p>Given the driving circuit of individual pixels, it is natural to extend it to drive an array of pixels, shown in <a href="#fig-amoled" class="quarto-xref">Figure&nbsp;<span>20.2</span></a>, which uses OLEDs as an example. The OLED pixels are organized similar to image sensor pixels and memory cells in a memory array. Each time only one row of pixels is activated (through <span class="math inline">\(V_{Select}\)</span>). Each row has a dedicated <span class="math inline">\(V_{Data}\)</span> signal, which delivers the necessary voltage to the corresponding pixel.</p>
<div id="fig-amoled" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-amoled-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/amoled.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-amoled-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.2: An array of active matrix OLED pixels and the driving circuit. Each pixel uses the 2T1C design in <a href="#fig-lcd_oled_pixel" class="quarto-xref">Figure&nbsp;<span>20.1</span></a> (b).
</figcaption>
</figure>
</div>
<p>If a display’s refresh rate is, say, 120 Hz, each row is selected 120 times a second. Each time, a new voltage is effectively programmed into the storage capacitor. Critically, even when a row is not selected, the charges in <span class="math inline">\(C_{storage}\)</span> are still there and can continuously drive the LED. Driving circuit that has in-pixel control and storage uses the so-called “active matrix” addressing scheme. You might have heard of AMOLED, which is essentially OLED displays that use the AM driving circuit.</p>
</section>
<section id="active-matrix-vs.-passive-matrix" class="level3" data-number="20.1.2">
<h3 data-number="20.1.2" class="anchored" data-anchor-id="active-matrix-vs.-passive-matrix"><span class="header-section-number">20.1.2</span> Active Matrix vs.&nbsp;Passive Matrix</h3>
<p>The driving circuit we have seen above uses the active matrix design. In the passive matrix (PM) design, there is no in-pixel TFTs or storage capacitor <span class="citation" data-cites="blankenbach2016direct">(<a href="references.html#ref-blankenbach2016direct" role="doc-biblioref">Blankenbach, Hudak, and Jentsch 2016</a>)</span>. <a href="#fig-pm_vs_am" class="quarto-xref">Figure&nbsp;<span>20.3</span></a> compares the PM and AM design.</p>
<div id="fig-pm_vs_am" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pm_vs_am-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/pm_vs_am.svg" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pm_vs_am-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.3: Comparing the passive matrix (a) and active matrix (b) driving architecture; from <span class="citation" data-cites="ma2016active">(<a href="references.html#ref-ma2016active" role="doc-biblioref">Ma 2016, figs. 4.20, 4.41</a>)</span>. The AM architecture has in-pixel control (TFTs) and storage (capacitor) that are absent in the PM design.
</figcaption>
</figure>
</div>
<p>Like the AM addressing scheme, in PM we still address pixels row by row. For LCDs, once a row is activated, we set the per-column voltage so that we get the proper voltage difference (<span class="math inline">\(V_{row} - V_{col}\)</span>) to drive an LC cell. For OLED displays, we address a row of pixels by connecting the row signal to ground, and the column signal needs to act as a current source so as to deliver a current through the OLED.</p>
<p>Critically, the pixel (whether LCD or OLED) is “off” whenever its row is not selected. Therefore, for the most part of a refresh cycle the pixels are off. As a result, we need to deliver a large voltage or current during the “on” period in order to get a desired luminance level. This increases the power consumption and reduces the device life time.</p>
<!-- Talk about PWM driving scheme. -->
</section>
</section>
<section id="sec-disp-dic" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="sec-disp-dic"><span class="header-section-number">20.2</span> Driver IC</h2>
<p>The backplane itself is more or less just the matrix shown in <a href="#fig-amoled" class="quarto-xref">Figure&nbsp;<span>20.2</span></a>, whose row and column signals (<span class="math inline">\(V_{Select}\)</span> and <span class="math inline">\(V_{Data}\)</span>, or scan and data drivers in <a href="#fig-pm_vs_am" class="quarto-xref">Figure&nbsp;<span>20.3</span></a>) need to be set externally. These driver signals come from an external driver IC. <span class="citation" data-cites="blankenbach2016active">Blankenbach (<a href="references.html#ref-blankenbach2016active" role="doc-biblioref">2016</a>)</span> and <span class="citation" data-cites="cristaldi2009liquid">Cristaldi, Pennisi, and Pulvirenti (<a href="references.html#ref-cristaldi2009liquid" role="doc-biblioref">2009, vol. 2, chap. 6</a>)</span> provide general descriptions of LCD driver ICs up until 10 years ago. Today’s driver ICs are more integrated and have more advanced features, but the general functionalities and principles remain.</p>
<div id="fig-display_driver_ic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-display_driver_ic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/display_driver_ic.svg" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-display_driver_ic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.4: Two driver ICs: (a) Raydium’s RM68090 driving LCDs (<span class="citation" data-cites="rm68090">Raydium (<a href="references.html#ref-rm68090" role="doc-biblioref">2011, p. 13</a>)</span>) and (b) OmniVision’s OD6631 driving AMOLED displays (<span class="citation" data-cites="od6631">OmniVision (<a href="references.html#ref-od6631" role="doc-biblioref">n.d.</a>)</span>).
</figcaption>
</figure>
</div>
<p><a href="#fig-display_driver_ic" class="quarto-xref">Figure&nbsp;<span>20.4</span></a> shows two examples of driver ICs; one is Raydium’s RM68090 meant to drive LCDs and the other is OmniVision’s OD6631 meant to drive AMOLED displays. Perhaps the most important function of a display driver IC is to set the row (gate) and the column (source) driver signals. In the case of RM68090, it interfaces with a display backplane that has 320 rows, each of which has 720 columns<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Therefore, RM68090 has 320 gate driver signals (<code>G[320:1]</code>) and 720 source driver signals (<code>S[720:1]</code>). Only one gate driver signal is ON at a time, since only one row is selected at a time, so the gate driver signals effectively are a 320-stage shifter register. Assuming the display refreshes at a rate of 60 Hz, the shift register must shift at a rate of 60 <span class="math inline">\(\times\)</span> 320 = 19.2 KHz.</p>
<p>OD6631 interfaces with AMOLED displays that use the gate-in-panel (GIP) technology where the shift registers are inside the backplane. The AMOLED can have up to 2800 rows, but the driver IC delivers only 20 gate driver signals (<code>GIP[19:0]</code>) to the panel. This implies that each gate signal controls 140 rows. With a 144 Hz refresh rate, shift register inside the backplane has to operate a rate of 144 <span class="math inline">\(\times\)</span> 2800 = 403.2 KHz, but the gate signals from the driver IC only have to shift at 1/20 of that rate (20.16 KHz).</p>
<p>Another difference between gate and source driver signals is that the former is a binary signal controlling whether a row is selected whereas the latter needs to have many digital levels to control the pixel luminance. Therefore, there are Digital-to-Analog Convertors (DACs) before the source driver signals. Both the gate and source driver signals are generated from level shifters, because the input voltage of the driver IC is usually much lower (e.g., below 3.3 <span class="math inline">\(\text{V}\)</span>) than that of the gate/source drivers; for instance, the gate driver signal in RM68090 is above 10 <span class="math inline">\(\text{V}\)</span> in order to select a row.</p>
<p>For mobile devices like smartphones, the driver IC is typically connected to the Systems-on-a-Chip (SoC), which has a display controller IP block. The display controller uses the DMA engine to pass frame data from the memory to the MIPI Display Serial Interface (DSI) transmitter (Tx) block, which serializes the data (since MIPI DSI is a serial interface) and transmits the data to the MIPI DSI receiver (Rx) on the driver IC — this is how frame data is passed between the host and the driver IC.</p>
<p>The driver IC then needs to unpack the data to extract pixels. For mobile displays usually integrate the <em>timing controller</em> (TCON), whose main main job is to decide which row/column drivers get which pixels at which time. For large displays like TVs, the TCON usually sits inside the display itself and is a separate IC.</p>
<p>Many driver ICs also include a small amount of built-in memory, or a frame buffer, which temporarily stores an entire frame of image data. This offloads the constant data transfer burden from the main processor, allowing it to send a new image to the driver IC only when a change is needed, while the driver handles the continuous task of refreshing the screen.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-blankenbach2016active" class="csl-entry" role="listitem">
Blankenbach, Karlheinz. 2016. <span>“Active Matrix Driving.”</span> In <em>Handbook of Visual Display Technology</em>, 2nd ed., 645–64. Springer.
</div>
<div id="ref-blankenbach2016direct" class="csl-entry" role="listitem">
Blankenbach, Karlheinz, Andreas Hudak, and Michael Jentsch. 2016. <span>“Direct Drive, Multiplex, and Passive Matrix.”</span> In <em>Handbook of Visual Display Technology</em>, 2nd ed., 621–44. Springer.
</div>
<div id="ref-cristaldi2009liquid" class="csl-entry" role="listitem">
Cristaldi, David JR, Salvatore Pennisi, and Francesco Pulvirenti. 2009. <em>Liquid Crystal Display Drivers: Techniques and Circuits</em>. Vol. 2. Springer.
</div>
<div id="ref-ma2016active" class="csl-entry" role="listitem">
Ma, Ruiqing. 2016. <span>“Active Matrix for OLED Displays.”</span> In <em>Handbook of Visual Display Technology</em>, 2nd ed., 1821–41. Springer.
</div>
<div id="ref-od6631" class="csl-entry" role="listitem">
OmniVision. n.d. <span>“<span>OD6631 AMOLED Driver Brief</span>.”</span>
</div>
<div id="ref-rm68090" class="csl-entry" role="listitem">
Raydium. 2011. <span>“<span class="nocase">RM68090 Data Sheet: Single Chip Driver with 262K color for 240RGBx320 a-Si TFT LCD</span>.”</span>
</div>
<div id="ref-tsujimura2017oled" class="csl-entry" role="listitem">
Tsujimura, Takatoshi. 2017. <em>OLED Display Fundamentals and Applications</em>. 2nd ed. John Wiley &amp; Sons.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Other configurations are possible depending on whether we use an NMOS or a PMOS transistor and whether we use a source-follower circuit or a constant-current circuit <span class="citation" data-cites="tsujimura2017oled">(<a href="references.html#ref-tsujimura2017oled" role="doc-biblioref">Tsujimura 2017, chap. 4.4.2</a>)</span>. What we describe here uses PMOS + constant-current circuit.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>240 pixel columns and 3 sub-pixels per pixel column, so 720 effective columns<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./display-optics.html" class="pagination-link" aria-label="Optical Mechanisms">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Optical Mechanisms</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./display-signal-processing.html" class="pagination-link" aria-label="Display Signal Processing">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Display Signal Processing</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/learnvisualcomputing/learnvisualcomputing.github.io/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>